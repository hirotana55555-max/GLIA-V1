# GLIA Phase 2.5 å®Œå…¨ä»•æ§˜æ›¸
**ChatGPT/Claude æŸ»èª­ç”¨çµ±åˆãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ**

---

**Version**: 2.5.0  
**ä½œæˆæ—¥**: 2025-12-10  
**ä½œæˆè€…**: Antigravity (User: ã²ã‚ã—)  
**ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹**: Phase 2å®Œäº† â†’ Phase 2.5 æº–å‚™ä¸­

---

## ğŸ“‹ ç›®æ¬¡

1. [ã‚¨ã‚°ã‚¼ã‚¯ãƒ†ã‚£ãƒ–ã‚µãƒãƒªãƒ¼](#1-ã‚¨ã‚°ã‚¼ã‚¯ãƒ†ã‚£ãƒ–ã‚µãƒãƒªãƒ¼)
2. [Grand Vision & ä¸­æ ¸æ€æƒ³](#2-grand-vision--ä¸­æ ¸æ€æƒ³)
3. [ç¾åœ¨ã®å®Ÿè£…çŠ¶æ…‹ï¼ˆPhase 2 å®Œäº†å†…å®¹ï¼‰](#3-ç¾åœ¨ã®å®Ÿè£…çŠ¶æ…‹phase-2-å®Œäº†å†…å®¹)
4. [Phase 2.5 ã®ç›®çš„ã¨å„ªå…ˆåº¦](#4-phase-25-ã®ç›®çš„ã¨å„ªå…ˆåº¦)
5. [ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£å…¨ä½“å›³](#5-ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£å…¨ä½“å›³)
6. [ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆè©³ç´°ä»•æ§˜](#6-ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆè©³ç´°ä»•æ§˜)
7. [TOON ã‚¹ã‚­ãƒ¼ãƒå®šç¾©](#7-toon-ã‚¹ã‚­ãƒ¼ãƒå®šç¾©)
8. [ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ­ãƒ¼ã¨ã‚·ãƒ¼ã‚±ãƒ³ã‚¹](#8-ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ­ãƒ¼ã¨ã‚·ãƒ¼ã‚±ãƒ³ã‚¹)
9. [å®Ÿè£…ã‚®ãƒ£ãƒƒãƒ—åˆ†æ](#9-å®Ÿè£…ã‚®ãƒ£ãƒƒãƒ—åˆ†æ)
10. [Phase 2.5 å®Ÿè£…ãƒ­ãƒ¼ãƒ‰ãƒãƒƒãƒ—](#10-phase-25-å®Ÿè£…ãƒ­ãƒ¼ãƒ‰ãƒãƒƒãƒ—)
11. [æ¤œè¨¼ãƒ»ãƒ†ã‚¹ãƒˆè¨ˆç”»](#11-æ¤œè¨¼ãƒ†ã‚¹ãƒˆè¨ˆç”»)
12. [ä»˜éŒ²](#12-ä»˜éŒ²)

---

## 1. ã‚¨ã‚°ã‚¼ã‚¯ãƒ†ã‚£ãƒ–ã‚µãƒãƒªãƒ¼

### 1.1 ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ¦‚è¦

**GLIA (Generative Language Integration Assistant)** ã¯ã€LLMç¾¤ï¼ˆAIã‚¹ã‚¦ã‚©ãƒ¼ãƒ ï¼‰ã«ã‚ˆã‚‹è‡ªå¾‹çš„ã‹ã¤ç›£æŸ»å¯èƒ½ãªã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢é–‹ç™ºãƒ—ãƒ­ã‚»ã‚¹ã‚’å®Ÿç¾ã™ã‚‹Electronãƒ™ãƒ¼ã‚¹ã®ãƒ‡ã‚¹ã‚¯ãƒˆãƒƒãƒ—ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã§ã™ã€‚

**ä¸»è¦æ©Ÿèƒ½**:
- **LLMç¾¤åˆ¶å¾¡**: è¤‡æ•°LLMã‚’å”èª¿å‹•ä½œã•ã›ã€å˜ä¸€LLMã®æ¬ ç‚¹ï¼ˆå¹»è¦šã€ãƒã‚¤ã‚¢ã‚¹ã€ä¸æ­£ç¢ºæ€§ï¼‰ã‚’ç›¸äº’è£œå®Œ
- **ãƒ–ãƒ©ã‚¦ã‚¶è‡ªå‹•æ“ä½œ**: é–‹ç™ºä¸­ã®Webã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’PlaywrightçµŒç”±ã§è‡ªå‹•ãƒ†ã‚¹ãƒˆãƒ»ãƒ‡ãƒãƒƒã‚°
- **å®‰å…¨ãªå®Ÿè¡Œç’°å¢ƒ**: SIE (Structured Instruction Executor) ã«ã‚ˆã‚‹ç ´å£Šçš„æ“ä½œã®é˜²æ­¢
- **å®Œå…¨ç›£æŸ»**: å…¨æ“ä½œã®ãƒˆãƒ¬ãƒ¼ã‚µãƒ“ãƒªãƒ†ã‚£ç¢ºä¿ï¼ˆJSONLå½¢å¼ã®AuditLogï¼‰
- **VS Code / ãƒ•ã‚¡ã‚¤ãƒ«ã‚·ã‚¹ãƒ†ãƒ çµ±åˆ**: AIç¾¤ãŒã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã‚’ç·¨é›†ãƒ»ãƒ¬ãƒ“ãƒ¥ãƒ¼ãƒ»ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°

### 1.2 Phase 2.5 ã®ä½ç½®ã¥ã‘

| ãƒ•ã‚§ãƒ¼ã‚º | å†…å®¹ | çŠ¶æ…‹ |
|---------|------|------|
| **Phase 1** | åŸºç›¤æ•´å‚™ï¼ˆBrowserManager, MemoryProfiler, ResourcePoolï¼‰ | âœ… å®Œäº† |
| **Phase 2** | TOON/Swarm/SIE ã®åŸºç¤å®Ÿè£…ã€Electronçµ±åˆ | âœ… å®Œäº†ï¼ˆMVPï¼‰ |
| **Phase 2.5** | **å‹•ä½œã™ã‚‹æ¦‚å¿µå®Ÿè¨¼ã‹ã‚‰å®Ÿç”¨å¯èƒ½ãªã‚·ã‚¹ãƒ†ãƒ ã¸ã®ç§»è¡Œ** | ğŸš§ ã“ã‚Œã‹ã‚‰ |
| **Phase 3** | å®Œå…¨è‡ªå¾‹AIé–‹ç™ºã‚·ã‚¹ãƒ†ãƒ ï¼ˆPeer Review Loop, è‡ªå·±ä¿®æ­£ï¼‰ | â³ å°†æ¥ |

Phase 2.5 ã¯ãƒ—ãƒ­ãƒˆã‚¿ã‚¤ãƒ—ã‹ã‚‰æœ¬ç•ªã¸æ©‹æ¸¡ã—ã™ã‚‹ãƒ•ã‚§ãƒ¼ã‚ºã§ã€å®ŸPlaywrightçµ±åˆã‚„å‹•çš„ãƒãƒªãƒ‡ãƒ¼ã‚¿ç­‰ã€å®Ÿç”¨ã«å¿…è¦ãªã‚³ã‚¢æ©Ÿèƒ½ã‚’å®Ÿè£…ã—ã¾ã™ã€‚

---

## 2. Grand Vision & ä¸­æ ¸æ€æƒ³

### 2.1 æœ€çµ‚ç›®æ¨™ï¼ˆUltimate Goalï¼‰

> **ã€ŒAIã‚¹ã‚¦ã‚©ãƒ¼ãƒ ãŒå”èª¿ã—ã¦é–‹ç™ºã‚¿ã‚¹ã‚¯ã‚’é‚è¡Œã—ã€å†å¸°çš„ãªãƒ”ã‚¢ãƒ¬ãƒ“ãƒ¥ãƒ¼ã‚’çµŒã¦æœ€é©è§£ã‚’æ¡æŠã™ã‚‹ã€ã‚·ã‚¹ãƒ†ãƒ ã®å®Ÿç¾**

### 2.2 ä¸­æ ¸å“²å­¦ï¼ˆRecursive Self-Evaluation Modelï¼‰

#### åŸå‰‡1: No External Judgeï¼ˆå¤–éƒ¨è©•ä¾¡è€…ã®æ’é™¤ï¼‰
- è©•ä¾¡ãƒ—ãƒ­ã‚»ã‚¹ã¯**ã‚¹ã‚¦ã‚©ãƒ¼ãƒ å†…éƒ¨ã§å®Œçµ**
- äººé–“ã¯ã€ŒQuest Giverï¼ˆä¾é ¼è€…ï¼‰ã€ãŠã‚ˆã³ã€Œæœ€çµ‚å—é ˜è€…ã€ã®ã¿
- è©•ä¾¡ãƒ»é¸åˆ¥ãƒ»ä¿®æ­£ã¯ã™ã¹ã¦AIç¾¤ãŒè‡ªå¾‹å®Ÿè¡Œ

#### åŸå‰‡2: Dynamic Evaluation Criteriaï¼ˆå‹•çš„è©•ä¾¡åŸºæº–ï¼‰
- ã€ŒæˆåŠŸã€ã®å®šç¾©ã¯ã‚¿ã‚¹ã‚¯ã”ã¨ã«å¯å¤‰
- Mission ã® `evaluation_prompt` ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã§ãƒ¡ãƒˆãƒªã‚¯ã‚¹ã‚’æŸ”è»Ÿã«æŒ‡å®š
- ã‚³ãƒ¼ãƒ‰å“è³ªã€å®Ÿè¡Œé€Ÿåº¦ã€ä¿å®ˆæ€§ã€ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãªã©å¤šè»¸è©•ä¾¡ãŒå¯èƒ½

#### åŸå‰‡3: Peer-Review Meritocracyï¼ˆãƒ”ã‚¢ãƒ¬ãƒ“ãƒ¥ãƒ¼å®ŸåŠ›ä¸»ç¾©ï¼‰
- è¤‡æ•°ã®Proposalã‚’ç”Ÿæˆã—ã€ç›¸äº’ãƒ¬ãƒ“ãƒ¥ãƒ¼ï¼ˆCritiqueï¼‰ã§è©•ä¾¡
- å¹³å‡ã‚¹ã‚³ã‚¢ãŒæœ€é«˜ã®Proposalã‚’æ¡æŠ
- ã‚³ãƒ³ã‚»ãƒ³ã‚µã‚¹ã§ã¯ãªãã€Œå“è¶Šæ€§ã€ã‚’é‡è¦–

#### åŸå‰‡4: Cognitive Diversityï¼ˆèªçŸ¥çš„å¤šæ§˜æ€§ï¼‰
- å„AIã«ç•°ãªã‚‹ã€ŒThought Schemaï¼ˆæ€è€ƒã‚¹ã‚­ãƒ¼ãƒï¼‰ã€ã‚’å‰²ã‚Šå½“ã¦
- ä¾‹: Criticï¼ˆæ‰¹åˆ¤çš„ï¼‰ã€Optimistï¼ˆæ¥½è¦³çš„ï¼‰ã€Historianï¼ˆå‰ä¾‹é‡è¦–ï¼‰ãªã©
- åŒè³ªçš„æ€è€ƒã«ã‚ˆã‚‹ç›²ç‚¹ã‚’å›é¿

### 2.3 äººé–“ã®å½¹å‰²

| ã‚¹ãƒ†ãƒ¼ã‚¸ | äººé–“ã®é–¢ä¸ |
|---------|----------|
| **Missionå®šç¾©** | âœ… å¿…é ˆ - è‡ªç„¶è¨€èªã§è¦ä»¶ã‚’è¨˜è¿° |
| **Proposalç”Ÿæˆ** | âŒ ä¸è¦ - AI Executor ãŒå®Ÿè¡Œ |
| **Critique/è©•ä¾¡** | âŒ ä¸è¦ - AI Reviewer ãŒå®Ÿè¡Œ |
| **Finalæ¡æŠ** | âš ï¸ ä»»æ„ - è‡ªå‹•æ¡æŠ or äººé–“æ‰¿èªï¼ˆè¨­å®šã«ã‚ˆã‚‹ï¼‰ |
| **ç ´å£Šçš„æ“ä½œã®æ‰¿èª** | âœ… å¿…é ˆ - ãƒ•ã‚¡ã‚¤ãƒ«å‰Šé™¤ã€å¤–éƒ¨APIå‘¼ã³å‡ºã—ç­‰ |

---

## 3. ç¾åœ¨ã®å®Ÿè£…çŠ¶æ…‹ï¼ˆPhase 2 å®Œäº†å†…å®¹ï¼‰

### 3.1 å®Ÿè£…æ¸ˆã¿ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ

#### âœ… BrowserManager (`@glia/browser-manager`)
- **è²¬å‹™**: ãƒ–ãƒ©ã‚¦ã‚¶ãƒ—ãƒ­ã‚»ã‚¹ãƒ»ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆãƒ»ãƒšãƒ¼ã‚¸ã®ãƒ©ã‚¤ãƒ•ã‚µã‚¤ã‚¯ãƒ«ç®¡ç†
- **å®Ÿè£…å†…å®¹**:
  - Playwrightçµ±åˆï¼ˆChromiumã®ã¿å¯¾å¿œï¼‰
  - ResourcePool ã«ã‚ˆã‚‹å¤šé‡èµ·å‹•é˜²æ­¢
  - PID ãƒˆãƒ©ãƒƒã‚­ãƒ³ã‚°ã€ãƒ¡ãƒ¢ãƒªãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ©
  - TTLï¼ˆTime-To-Liveï¼‰ãƒ™ãƒ¼ã‚¹ã®è‡ªå‹•ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—
  - Context/Page ã®å†åˆ©ç”¨ãƒãƒªã‚·ãƒ¼
- **å®Ÿè£…çŠ¶æ³**: **90%å®Œæˆ** - å®Ÿãƒ–ãƒ©ã‚¦ã‚¶æ“ä½œã¯å‹•ä½œç¢ºèªæ¸ˆã¿
- **èª²é¡Œ**: è¤‡æ•°ãƒ–ãƒ©ã‚¦ã‚¶ã‚¨ãƒ³ã‚¸ãƒ³å¯¾å¿œï¼ˆFirefox, WebKitï¼‰ã¯æœªå®Ÿè£…

#### âœ… SIE (`@glia/sie`)
- **è²¬å‹™**: TOON Instruction ã‚’å®‰å…¨ã«å®Ÿè¡Œ
- **å®Ÿè£…å†…å®¹**:
  - `SIEParser`: Instructioné…åˆ—ã‚’ASTã«å¤‰æ›
  - `SIEValidator`: ã‚¹ã‚­ãƒ¼ãƒæ¤œè¨¼ï¼ˆZodä½¿ç”¨ï¼‰
  - `SIEExecutorV2`: ãƒªã‚¹ã‚¯è©•ä¾¡ + ãƒ¦ãƒ¼ã‚¶ãƒ¼æ‰¿èªãƒ•ãƒ­ãƒ¼
  - Sandboxæ©Ÿèƒ½ï¼ˆç ´å£Šçš„æ“ä½œã®æ¤œå‡ºï¼‰
- **å®Ÿè£…çŠ¶æ³**: **60%å®Œæˆ** - åŸºæœ¬ãƒ•ãƒ­ãƒ¼ã¯å‹•ä½œã™ã‚‹ãŒå®ŸPlaywrightçµ±åˆã¯æœªå®Œ
- **èª²é¡Œ**:
  - å®Ÿéš›ã®DOMæ“ä½œï¼ˆnavigate, click, inputï¼‰ãŒãƒ¢ãƒƒã‚¯
  - å‹•çš„ãƒãƒªãƒ‡ãƒ¼ã‚¿ï¼ˆLLMã«ã‚ˆã‚‹äº‹å‰æ¤œè¨¼ï¼‰æœªå®Ÿè£…

#### âœ… Swarm Orchestrator (`@glia/swarm`)
- **è²¬å‹™**: Mission â†’ Proposal â†’ Critique â†’ ScoreCard ã®å…¨ä½“ã‚ªãƒ¼ã‚±ã‚¹ãƒˆãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³
- **å®Ÿè£…å†…å®¹**:
  - OpenRouter APIçµŒç”±ã§LLMå‘¼ã³å‡ºã—ï¼ˆGPT-3.5-turboä½¿ç”¨ï¼‰
  - Proposalç”Ÿæˆï¼ˆExecutor Agentï¼‰
  - Fallbackãƒ¢ãƒƒã‚¯ï¼ˆAPIã‚­ãƒ¼ç„¡ã—ã§ã‚‚ãƒ†ã‚¹ãƒˆå¯èƒ½ï¼‰
- **å®Ÿè£…çŠ¶æ³**: **50%å®Œæˆ** - Critique/Reviewæ©Ÿèƒ½ã¯æœªå®Ÿè£…
- **èª²é¡Œ**:
  - Peer Review Loop ãŒæœªå®Ÿè£…
  - è¤‡æ•°Proposalã®ä¸¦åˆ—ç”Ÿæˆãƒ»æ¯”è¼ƒãŒæœªå®Ÿè£…

#### âœ… TOON Schemas (`@glia/toon`)
- **è²¬å‹™**: LLMé–“é€šä¿¡ã®ã‚¹ã‚­ãƒ¼ãƒå®šç¾©
- **å®Ÿè£…å†…å®¹**:
  - Mission, Proposal, Critique, ScoreCard ã®Zodã‚¹ã‚­ãƒ¼ãƒ
  - Instructionï¼ˆnavigate, click, input, extract, noopï¼‰
- **å®Ÿè£…çŠ¶æ³**: **80%å®Œæˆ** - åŸºæœ¬ã‚¹ã‚­ãƒ¼ãƒã¯ç¢ºç«‹
- **èª²é¡Œ**:
  - `extract`ï¼ˆãƒ‡ãƒ¼ã‚¿æŠ½å‡ºï¼‰ã®è©³ç´°ä»•æ§˜ãŒæœªå®šç¾©
  - ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ç”¨ã‚¹ã‚­ãƒ¼ãƒãŒä¸è¶³

#### âœ… Electron App (`apps/electron-app`)
- **è²¬å‹™**: ãƒ‡ã‚¹ã‚¯ãƒˆãƒƒãƒ—UIã¨IPCãƒ–ãƒªãƒƒã‚¸
- **å®Ÿè£…å†…å®¹**:
  - IPC handlersï¼ˆsynthesize-prompt, send-to-llm, get-resource-stats, force-cleanupï¼‰
  - BrowserManager ã¨ BrowserAgent ã®çµ±åˆ
  - electron-store ã«ã‚ˆã‚‹æ°¸ç¶šåŒ–
- **å®Ÿè£…çŠ¶æ³**: **70%å®Œæˆ** - åŸºæœ¬UIã¯å‹•ä½œ
- **èª²é¡Œ**:
  - GUIãŒæœªå®Ÿè£…ï¼ˆç¾åœ¨ã¯CLIçš„åˆ©ç”¨ã®ã¿ï¼‰
  - Missionç®¡ç†ç”»é¢ãŒæœªå®Ÿè£…

#### âœ… Audit Logger (`@glia/audit`)
- **è²¬å‹™**: å…¨æ“ä½œã®ç›£æŸ»ãƒ­ã‚°è¨˜éŒ²
- **å®Ÿè£…å†…å®¹**:
  - JSONLå½¢å¼ã§ã®ãƒ­ã‚°å‡ºåŠ›
  - ã‚¿ã‚¤ãƒ ã‚¹ã‚¿ãƒ³ãƒ—ã€sourceã€actionã€payload ã®è¨˜éŒ²
- **å®Ÿè£…çŠ¶æ³**: **90%å®Œæˆ**
- **èª²é¡Œ**: ãƒ­ã‚°ãƒ­ãƒ¼ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ã€ZIPåœ§ç¸®ã€æ³•çš„ä¿ç®¡æ©Ÿèƒ½ãŒæœªå®Ÿè£…

### 3.2 ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹é€ ï¼ˆç¾çŠ¶ï¼‰

```
GLIA-V1/
â”œâ”€â”€ packages/                    # NPM Workspaces
â”‚   â”œâ”€â”€ browser-manager/         # ãƒ–ãƒ©ã‚¦ã‚¶åˆ¶å¾¡ã‚³ã‚¢
â”‚   â”œâ”€â”€ browser-agent/           # Playwrightçµ±åˆã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ
â”‚   â”œâ”€â”€ sie/                     # Structured Instruction Executor
â”‚   â”œâ”€â”€ swarm/                   # Swarm Orchestrator
â”‚   â”œâ”€â”€ toon/                    # TOON Schemaå®šç¾©
â”‚   â”œâ”€â”€ audit/                   # AuditLogger
â”‚   â”œâ”€â”€ api-client/              # OpenRouter APIã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆ
â”‚   â””â”€â”€ prompt-core/             # ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆåˆæˆãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£
â”œâ”€â”€ apps/
â”‚   â””â”€â”€ electron-app/            # Electronãƒ¡ã‚¤ãƒ³ã‚¢ãƒ—ãƒª
â”œâ”€â”€ ANTIGRAVITY_IMPL/            # Antigravityï¼ˆNode.jsäº’æ›Sandboxï¼‰å®Ÿè£…
â”‚   â””â”€â”€ ts-src/
â”‚       â”œâ”€â”€ browser-manager/     # ãƒ¢ãƒƒã‚¯BrowserManagerï¼ˆåˆæœŸãƒ—ãƒ­ãƒˆã‚¿ã‚¤ãƒ—ï¼‰
â”‚       â”œâ”€â”€ sie/                 # ãƒ¢ãƒƒã‚¯SIE
â”‚       â””â”€â”€ swarm/               # ãƒ¢ãƒƒã‚¯SwarmMissionRunner
â”œâ”€â”€ SPECIFICATION/               # ä»•æ§˜æ›¸ç¾¤
â”‚   â”œâ”€â”€ DOCS/                    # UMLç­‰ã®è©³ç´°ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ
â”‚   â”œâ”€â”€ UML/                     # PlantUMLç”Ÿæˆç”»åƒ
â”‚   â””â”€â”€ SCRIPTS/                 # è‡ªå‹•åŒæœŸã‚¹ã‚¯ãƒªãƒ—ãƒˆ
â””â”€â”€ TEMP/                        # å®Ÿé¨“ãƒ»æ¤œè¨¼ç”¨ï¼ˆå‰Šé™¤å¯èƒ½ï¼‰
```

### 3.3 æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯

| ãƒ¬ã‚¤ãƒ¤ãƒ¼ | æŠ€è¡“ |
|---------|------|
| **ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯** | Electron 28.x |
| **è¨€èª** | TypeScript 5.x |
| **ãƒ–ãƒ©ã‚¦ã‚¶è‡ªå‹•åŒ–** | Playwright 1.40+ (Chromium) |
| **ã‚¹ã‚­ãƒ¼ãƒæ¤œè¨¼** | Zod 3.x |
| **LLM API** | OpenRouter (GPT-3.5/4, Claude, etc.) |
| **ãƒ­ã‚°å½¢å¼** | JSONL (JSON Lines) |
| **ãƒ“ãƒ«ãƒ‰ãƒ„ãƒ¼ãƒ«** | tsc (TypeScript Compiler) |
| **ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ç®¡ç†** | npm workspaces |

---

## 4. Phase 2.5 ã®ç›®çš„ã¨å„ªå…ˆåº¦

### 4.1 ç›®çš„

Phase 2.5 ã¯**ã€Œå‹•ä½œã™ã‚‹æ¦‚å¿µå®Ÿè¨¼ã€ã‹ã‚‰ã€Œå®Ÿç”¨å¯èƒ½ãªã‚·ã‚¹ãƒ†ãƒ ã€ã¸ã®ç§»è¡Œ**ã‚’ç›®æŒ‡ã—ã¾ã™ã€‚

#### ã‚´ãƒ¼ãƒ«
1. **å®ŸPlaywrightçµ±åˆ**: ãƒ¢ãƒƒã‚¯ã§ã¯ãªãå®Ÿéš›ã®ãƒ–ãƒ©ã‚¦ã‚¶æ“ä½œã‚’å®Ÿè¡Œ
2. **å‹•çš„ãƒãƒªãƒ‡ãƒ¼ã‚¿**: LLMã«ã‚ˆã‚‹äº‹å‰æ¤œè¨¼ã§ä¸æ­£ãªInstructionã‚’æ’é™¤
3. **DOMè§£æã‚¨ãƒ³ã‚¸ãƒ³**: å‹•çš„ãªã‚»ãƒ¬ã‚¯ã‚¿ç”Ÿæˆã§å …ç‰¢æ€§å‘ä¸Š
4. **ãƒ†ã‚¹ãƒˆè‡ªå‹•åŒ–**: LLMãŒãƒ†ã‚¹ãƒˆã‚³ãƒ¼ãƒ‰ã‚’ç”Ÿæˆãƒ»å®Ÿè¡Œã—ã€è‡ªå·±æ¤œè¨¼
5. **Peer Reviewå®Ÿè£…**: è¤‡æ•°Proposalã®ç”Ÿæˆã¨ç›¸äº’è©•ä¾¡

### 4.2 å„ªå…ˆåº¦ãƒãƒˆãƒªã‚¯ã‚¹

| é …ç›® | å„ªå…ˆåº¦ | ç†ç”± |
|------|-------|------|
| **å®ŸPlaywrightçµ±åˆ** | ğŸ”´ æœ€é«˜ | Phase 2.5 ã®ä¸­æ ¸ã€‚ã“ã‚ŒãŒãªã„ã¨å®Ÿç”¨ä¸å¯ |
| **å‹•çš„ãƒãƒªãƒ‡ãƒ¼ã‚¿** | ğŸ”´ æœ€é«˜ | LLMã®å¹»è¦šã«ã‚ˆã‚‹ç ´å£Šçš„æ“ä½œã‚’é˜²ã |
| **DOMè§£æï¼‹ã‚»ãƒ¬ã‚¯ã‚¿ç”Ÿæˆ** | ğŸŸ  é«˜ | å‹•çš„Webã‚¢ãƒ—ãƒªã§ã®ãƒ­ãƒã‚¹ãƒˆæ€§å‘ä¸Šã«å¿…é ˆ |
| **ãƒ†ã‚¹ãƒˆè‡ªå‹•åŒ–ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³** | ğŸŸ¡ ä¸­ | è‡ªå·±æ¤œè¨¼ãƒ«ãƒ¼ãƒ—ã®åŸºç›¤ã ãŒã€æ‰‹å‹•ãƒ†ã‚¹ãƒˆã§ã‚‚ä»£æ›¿å¯èƒ½ |
| **Peer Reviewå®Ÿè£…** | ğŸŸ¡ ä¸­ | Grand Visionã®ä¸­æ ¸ã ãŒã€å˜ä¸€Proposalã§ã‚‚ä¾¡å€¤æä¾›å¯èƒ½ |
| **ã‚»ãƒãƒ³ãƒ†ã‚£ãƒƒã‚¯ãƒãƒ£ãƒ³ã‚­ãƒ³ã‚°** | ğŸŸ¢ ä½ | Phase 3ä»¥é™ã§å¯¾å¿œï¼ˆå¤§è¦æ¨¡ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå¯¾å¿œï¼‰ |

---

## 5. ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£å…¨ä½“å›³

### 5.1 ãƒ¬ã‚¤ãƒ¤ãƒ¼æ§‹é€ ï¼ˆ3.5å±¤ãƒ¢ãƒ‡ãƒ«ï¼‰

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Layer 4: Presentationï¼ˆãƒ—ãƒ¬ã‚¼ãƒ³ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³å±¤ï¼‰         â”‚
â”‚  - Electron UI (Reactäºˆå®š)                           â”‚
â”‚  - CLI Interface                                     â”‚
â”‚  - REST API (å°†æ¥)                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â†“ IPC / HTTP
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Layer 2: Applicationï¼ˆã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³å±¤ï¼‰           â”‚
â”‚  - SwarmOrchestrator: Missionç®¡ç†ã€Workflowåˆ¶å¾¡      â”‚
â”‚  - PolicyManager: æ‰¿èªãƒãƒªã‚·ãƒ¼ã€ãƒªã‚¹ã‚¯åˆ¤å®š             â”‚
â”‚  - TaskScheduler: ã‚¿ã‚¹ã‚¯ã‚­ãƒ¥ãƒ¼ç®¡ç†                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Layer 3: Infrastructureï¼ˆã‚¤ãƒ³ãƒ•ãƒ©å±¤ï¼‰                â”‚
â”‚  - SIE Executor: Instructionå®Ÿè¡Œã‚¨ãƒ³ã‚¸ãƒ³              â”‚
â”‚  - BrowserManager: Browser/Context/Pageç®¡ç†          â”‚
â”‚  - ResourcePool: ãƒªã‚½ãƒ¼ã‚¹ãƒ—ãƒ¼ãƒ«                       â”‚
â”‚  - AuditLogger: ç›£æŸ»ãƒ­ã‚°                             â”‚
â”‚  - APIClient: LLM APIé€šä¿¡                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Layer 3.5: Sandboxï¼ˆå®‰å…¨å®Ÿè¡Œå±¤ï¼‰                     â”‚
â”‚  - Antigravity Sandbox: Node.jsäº’æ›ã‚µãƒ³ãƒ‰ãƒœãƒƒã‚¯ã‚¹     â”‚
â”‚  - Risk Assessor: ç ´å£Šçš„æ“ä½œæ¤œå‡º                      â”‚
â”‚  - User Approval Flow: äººé–“æ‰¿èªãƒ•ãƒ­ãƒ¼                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Layer 1: Domainï¼ˆãƒ‰ãƒ¡ã‚¤ãƒ³å±¤ï¼‰                        â”‚
â”‚  - TOON Schemas: Mission, Proposal, Critique, etc.   â”‚
â”‚  - SessionModel: ã‚»ãƒƒã‚·ãƒ§ãƒ³çŠ¶æ…‹ç®¡ç†                    â”‚
â”‚  - BrowserModel: ãƒ–ãƒ©ã‚¦ã‚¶çŠ¶æ…‹ãƒ¢ãƒ‡ãƒ«                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Layer 0: Foundationï¼ˆåŸºç›¤å±¤ï¼‰                        â”‚
â”‚  - Logger: çµ±åˆãƒ­ã‚°ã‚·ã‚¹ãƒ†ãƒ                            â”‚
â”‚  - Config: è¨­å®šç®¡ç†                                  â”‚
â”‚  - EventBus: ã‚¤ãƒ™ãƒ³ãƒˆé§†å‹•é€šä¿¡                         â”‚
â”‚  - ErrorMonitor: ã‚¨ãƒ©ãƒ¼ç›£è¦–                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 5.2 ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆé–“ä¾å­˜é–¢ä¿‚

```mermaid
graph TD
    ElectronUI[Electron UI] --> Orchestrator[SwarmOrchestrator]
    CLI[CLI] --> Orchestrator
    
    Orchestrator --> APIClient[GliaApiClient]
    Orchestrator --> SIEExecutor[SIE Executor]
    Orchestrator --> AuditLogger[AuditLogger]
    
    SIEExecutor --> BrowserManager[BrowserManager]
    SIEExecutor --> SIEParser[SIEParser]
    SIEExecutor --> SIEValidator[SIEValidator]
    SIEExecutor --> RiskAssessor[Risk Assessor]
    
    BrowserManager --> ResourcePool[ResourcePool]
    BrowserManager --> PIDTracker[PIDTracker]
    BrowserManager --> Playwright[Playwright]
    
    SIEParser --> TOONSchemas[TOON Schemas]
    SIEValidator --> TOONSchemas
    
    APIClient --> OpenRouter[OpenRouter API]
```

---

## 6. ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆè©³ç´°ä»•æ§˜

### 6.1 BrowserManager

#### è²¬å‹™
- ãƒ–ãƒ©ã‚¦ã‚¶ãƒ—ãƒ­ã‚»ã‚¹ã®ãƒ©ã‚¤ãƒ•ã‚µã‚¤ã‚¯ãƒ«ç®¡ç†
- Context (ãƒ–ãƒ©ã‚¦ã‚¶ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ç›¸å½“) ã®ç®¡ç†
- Page (ã‚¿ãƒ–) ã®ç®¡ç†
- ãƒªã‚½ãƒ¼ã‚¹å†åˆ©ç”¨ã«ã‚ˆã‚‹ãƒ¡ãƒ¢ãƒªåŠ¹ç‡åŒ–

#### API

```typescript
class BrowserManager {
  // ã‚·ãƒ³ã‚°ãƒ«ãƒˆãƒ³ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹å–å¾—
  static getInstance(): BrowserManager;
  
  // Contextå–å¾—ï¼ˆæ–°è¦ä½œæˆ or å†åˆ©ç”¨ï¼‰
  acquireContext(options?: AcquireContextOptions): Promise<ContextRecord>;
  
  // Contextè§£æ”¾ï¼ˆå†åˆ©ç”¨ãƒ—ãƒ¼ãƒ«ã«æˆ»ã™ï¼‰
  releaseContext(context: ContextRecord): void;
  
  // å…¨ãƒªã‚½ãƒ¼ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—
  cleanupAll(options?: CleanupOptions): Promise<void>;
  
  // ãƒªã‚½ãƒ¼ã‚¹çµ±è¨ˆæƒ…å ±
  getResourcePoolStats(): ResourcePoolStats;
  
  // Actionå®Ÿè¡Œï¼ˆSIEã‹ã‚‰å‘¼ã°ã‚Œã‚‹ï¼‰
  runAction(
    process: BrowserRecord, 
    context: ContextRecord, 
    page: PageRecord, 
    action: Instruction
  ): Promise<ActionResult>;
}
```

#### å‹å®šç¾©

```typescript
interface BrowserRecord {
  pid: string;              // ãƒ—ãƒ­ã‚»ã‚¹IDï¼ˆå†…éƒ¨ç®¡ç†ç”¨ï¼‰
  browser: Browser;         // Playwright Browserã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹
  createdAt: number;        // ä½œæˆã‚¿ã‚¤ãƒ ã‚¹ã‚¿ãƒ³ãƒ—
  lastUsed: number;         // æœ€çµ‚ä½¿ç”¨ã‚¿ã‚¤ãƒ ã‚¹ã‚¿ãƒ³ãƒ—
}

interface ContextRecord {
  id: string;
  context: BrowserContext;  // Playwright BrowserContext
  pages: Map<string, PageRecord>;
  createdAt: number;
  lastUsed: number;
}

interface PageRecord {
  id: string;
  page: Page;               // Playwright Page
  url: string;              // ç¾åœ¨ã®URL
  createdAt: number;
}

interface AcquireContextOptions {
  requireCleanContext?: boolean;  // æ–°è¦Contextã‚’å¼·åˆ¶
  reuseExisting?: boolean;        // å†åˆ©ç”¨ã‚’è©¦ã¿ã‚‹
}

interface CleanupOptions {
  forceKillProcesses?: boolean;   // ãƒ—ãƒ­ã‚»ã‚¹å¼·åˆ¶çµ‚äº†
  timeoutMs?: number;              // ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ10ç§’ï¼‰
}

interface ResourcePoolStats {
  activeBrowsers: number;
  activeContexts: number;
  activePages: number;
  poolSize: number;
  memoryUsageMB: number;
}
```

#### å®Ÿè£…ã‚®ãƒ£ãƒƒãƒ—
- âœ… å®Ÿè£…æ¸ˆã¿: åŸºæœ¬çš„ãªãƒ©ã‚¤ãƒ•ã‚µã‚¤ã‚¯ãƒ«ç®¡ç†
- âŒ æœªå®Ÿè£…: è¤‡æ•°ãƒ–ãƒ©ã‚¦ã‚¶ã‚¨ãƒ³ã‚¸ãƒ³å¯¾å¿œï¼ˆFirefox, WebKitï¼‰
- âŒ æœªå®Ÿè£…: åˆ†æ•£ç’°å¢ƒå¯¾å¿œï¼ˆãƒªãƒ¢ãƒ¼ãƒˆPlaywright Gridï¼‰

---

### 6.2 SIE (Structured Instruction Executor)

#### è²¬å‹™
- TOON Instruction ã®è§£æãƒ»æ¤œè¨¼ãƒ»å®Ÿè¡Œ
- ãƒªã‚¹ã‚¯è©•ä¾¡ã¨ãƒ¦ãƒ¼ã‚¶ãƒ¼æ‰¿èªãƒ•ãƒ­ãƒ¼
- å®Ÿè¡Œçµæœã®ç›£æŸ»ãƒ­ã‚°è¨˜éŒ²

#### ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£

```
Instruction[] (JSON)
    â†“
[SIEParser] â†’ InstructionAST[]
    â†“
[SIEValidator] â†’ Validation Result
    â†“
[Risk Assessor] â†’ Risk[] (ç ´å£Šçš„æ“ä½œæ¤œå‡º)
    â†“
[User Approval] â†’ boolean (å¿…è¦æ™‚ã®ã¿)
    â†“
[SIEExecutor] â†’ BrowserManager.runAction()
    â†“
ActionResult[] â†’ AuditLogger
```

#### API

```typescript
class SIEExecutorV2 {
  constructor(
    pool: ResourcePool, 
    audit: AuditLogger
  );
  
  async execute(
    ast: InstructionAST[], 
    options?: {
      userApprovalCallback?: (risks: Risk[]) => Promise<boolean>;
    }
  ): Promise<ExecutionResult>;
}
```

```typescript
interface InstructionAST {
  id: string;
  action: "navigate" | "click" | "input" | "extract" | "noop";
  target?: string;      // CSSã‚»ãƒ¬ã‚¯ã‚¿ or URL
  value?: string;       // inputæ™‚ã®ãƒ†ã‚­ã‚¹ãƒˆ
  options?: Record<string, any>;
  meta?: Record<string, any>;
}

interface Risk {
  instructionId: string;
  severity: "low" | "medium" | "high" | "critical";
  reason: string;
  requiresUserApproval: boolean;
}

interface ExecutionResult {
  aborted: boolean;
  reason?: string;
  risky?: Risk[];
  results?: ActionResult[];
}

interface ActionResult {
  ok: boolean;
  data?: any;           // extractæ™‚ã®æŠ½å‡ºãƒ‡ãƒ¼ã‚¿
  screenshot?: string;  // Base64ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰ç”»åƒ
  error?: string;
}
```

#### ãƒªã‚¹ã‚¯è©•ä¾¡ãƒ«ãƒ¼ãƒ«

| æ“ä½œ | ãƒªã‚¹ã‚¯ãƒ¬ãƒ™ãƒ« | æ‰¿èªè¦å¦ |
|------|------------|---------|
| navigate | Low | âŒ ä¸è¦ |
| click | Low | âŒ ä¸è¦ |
| inputï¼ˆä¸€èˆ¬ãƒ†ã‚­ã‚¹ãƒˆï¼‰ | Low | âŒ ä¸è¦ |
| inputï¼ˆãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãƒ»ã‚¯ãƒ¬ã‚«ï¼‰ | High | âœ… å¿…è¦ |
| extract | Low | âŒ ä¸è¦ |
| filesystem_write | Critical | âœ… å¿…è¦ |
| external_api_call | High | âœ… å¿…è¦ |

#### å®Ÿè£…ã‚®ãƒ£ãƒƒãƒ—
- âœ… å®Ÿè£…æ¸ˆã¿: ãƒªã‚¹ã‚¯è©•ä¾¡ã€æ‰¿èªãƒ•ãƒ­ãƒ¼
- âŒ æœªå®Ÿè£…: å®ŸPlaywrightçµ±åˆï¼ˆç¾åœ¨ã¯ãƒ¢ãƒƒã‚¯ï¼‰
- âŒ æœªå®Ÿè£…: `extract` ã®å®Ÿè£…ï¼ˆDOMã‚¹ã‚¯ãƒ¬ã‚¤ãƒ”ãƒ³ã‚°ï¼‰
- âŒ æœªå®Ÿè£…: å‹•çš„ãƒãƒªãƒ‡ãƒ¼ã‚¿ï¼ˆLLMäº‹å‰æ¤œè¨¼ï¼‰

---

### 6.3 SwarmOrchestrator

#### è²¬å‹™
- Mission â†’ Proposal â†’ Critique â†’ ScoreCard ã®å…¨ä½“ãƒ•ãƒ­ãƒ¼åˆ¶å¾¡
- LLM APIå‘¼ã³å‡ºã—ï¼ˆOpenRouterçµŒç”±ï¼‰
- Proposalç”Ÿæˆãƒ»è©•ä¾¡ãƒ»é¸æŠ

#### ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼

```
1. Missionå—ä¿¡ï¼ˆHuman Quest Giverï¼‰
   â†“
2. Executor Agentå‘¼ã³å‡ºã—ï¼ˆLLM: GPT-4 etc.ï¼‰
   â†’ Proposalç”Ÿæˆï¼ˆinstructionså«ã‚€ï¼‰
   â†“
3. SIEParser/Validator ã§æ¤œè¨¼
   â†“
4. SIEExecutor ã§å®Ÿè¡Œ
   â†“
5. Reviewer Agentå‘¼ã³å‡ºã—ï¼ˆè¤‡æ•°LLMï¼‰
   â†’ Critiqueç”Ÿæˆï¼ˆscore + feedbackï¼‰
   â†“
6. ScoreCardé›†è¨ˆ
   â†’ æœ€é«˜ã‚¹ã‚³ã‚¢ã®Proposalã‚’æ¡æŠ
   â†“
7. çµæœã‚’Humanã«å ±å‘Š
```

#### API

```typescript
class SwarmOrchestrator {
  constructor(apiKey: string);
  
  async runMission(mission: Mission): Promise<ScoreCard>;
  
  close(): void;  // ãƒªã‚½ãƒ¼ã‚¹è§£æ”¾
}
```

#### å®Ÿè£…ã‚®ãƒ£ãƒƒãƒ—
- âœ… å®Ÿè£…æ¸ˆã¿: Mission â†’ Proposal â†’ å®Ÿè¡Œ ã®åŸºæœ¬ãƒ•ãƒ­ãƒ¼
- âŒ æœªå®Ÿè£…: Critiqueç”Ÿæˆï¼ˆReviewer Agentï¼‰
- âŒ æœªå®Ÿè£…: è¤‡æ•°Proposalã®ä¸¦åˆ—ç”Ÿæˆãƒ»æ¯”è¼ƒ
- âŒ æœªå®Ÿè£…: ScoreCardé›†è¨ˆãƒ­ã‚¸ãƒƒã‚¯

---

### 6.4 TOON Schemas

#### Missionï¼ˆQuestï¼‰
```typescript
interface Mission {
  id: string;          // UUID
  title: string;       // çŸ­ã„ã‚¿ã‚¤ãƒˆãƒ«
  description: string; // è©³ç´°ãªè¦ä»¶è¨˜è¿°
  evaluation_prompt: string;  // è©•ä¾¡åŸºæº–ï¼ˆå‹•çš„ï¼‰
  created_at: string;  // ISO 8601
  created_by: string;  // ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ: "human"
}
```

#### Proposalï¼ˆSolutionï¼‰
```typescript
interface Proposal {
  id: string;
  mission_id: string;
  author_id: string;     // Agent ID (ä¾‹: "executor-gpt4")
  content: string;       // ææ¡ˆå†…å®¹ã®èª¬æ˜
  reasoning?: string;    // ãªãœã“ã®è§£æ±ºç­–ã‚’é¸ã‚“ã ã‹
  instructions?: Instruction[];  // SIEå®Ÿè¡Œç”¨
  metadata?: Record<string, any>;
  created_at: string;
}
```

#### Critiqueï¼ˆReviewï¼‰
```typescript
interface Critique {
  id: string;
  proposal_id: string;
  reviewer_id: string;   // Agent ID (ä¾‹: "reviewer-claude")
  feedback: string;      // è©³ç´°ãªãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯
  score: number;         // 0-100
  created_at: string;
}
```

#### ScoreCardï¼ˆVerdictï¼‰
```typescript
interface ScoreCard {
  proposal_id: string;
  mission_id: string;
  average_score: number;
  critique_count: number;
  status: "ACCEPTED" | "REJECTED" | "NEEDS_REVISION";
  final_comment?: string;
}
```

---

## 7. TOON ã‚¹ã‚­ãƒ¼ãƒå®šç¾©

### 7.1 Instruction Schemaï¼ˆè©³ç´°ï¼‰
```typescript
type InstructionAction = 
  | "navigate"   // URLã¸é·ç§»
  | "click"      // è¦ç´ ã‚’ã‚¯ãƒªãƒƒã‚¯
  | "input"      // ãƒ†ã‚­ã‚¹ãƒˆå…¥åŠ›
  | "extract"    // ãƒ‡ãƒ¼ã‚¿æŠ½å‡º
  | "wait"       // å¾…æ©Ÿï¼ˆæ–°è¦è¿½åŠ äºˆå®šï¼‰
  | "screenshot" // ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ã‚·ãƒ§ãƒƒãƒˆå–å¾—ï¼ˆæ–°è¦è¿½åŠ äºˆå®šï¼‰
  | "noop";      // ä½•ã‚‚ã—ãªã„ï¼ˆãƒ†ã‚¹ãƒˆç”¨ï¼‰

interface Instruction {
  action: InstructionAction;
  target?: string;  // CSSã‚»ãƒ¬ã‚¯ã‚¿ or URL
  value?: string;   // inputæ™‚ã®ãƒ†ã‚­ã‚¹ãƒˆ
  options?: {
    timeout?: number;        // ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆï¼ˆmsï¼‰
    waitForSelector?: string; // è¦ç´ å‡ºç¾ã‚’å¾…ã¤
    screenshot?: boolean;    // å®Ÿè¡Œå¾Œã«ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ã‚·ãƒ§ãƒƒãƒˆ
  };
  meta?: {
    description?: string;  // äººé–“å¯èª­ãªèª¬æ˜
    expectedResult?: any;  // æœŸå¾…ã•ã‚Œã‚‹çµæœï¼ˆæ¤œè¨¼ç”¨ï¼‰
  };
}
```

### 7.2 Action Typeåˆ¥ã®ä»•æ§˜

#### navigate
```typescript
{
  action: "navigate",
  target: "https://www.google.com",
  options: {
    timeout: 30000,
    waitForSelector: "textarea[name='q']"
  }
}
```

#### click
```typescript
{
  action: "click",
  target: "button#submit",
  options: {
    timeout: 5000
  }
}
```

#### input
```typescript
{
  action: "input",
  target: "input#username",
  value: "test_user",
  options: {
    clearBefore: true,  // å…¥åŠ›å‰ã«ã‚¯ãƒªã‚¢
    pressEnter: false   // EnteræŠ¼ä¸‹
  }
}
```

#### extract
```typescript
{
  action: "extract",
  target: "div.result",
  options: {
    extractType: "text" | "html" | "attribute",
    attributeName?: "href",  // extractType=attributeã®å ´åˆ
    multiple: true,          // è¤‡æ•°è¦ç´ æŠ½å‡º
    selector: "h3"           // å­è¦ç´ ã‚»ãƒ¬ã‚¯ã‚¿
  }
}
```

---

## 8. ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ­ãƒ¼ã¨ã‚·ãƒ¼ã‚±ãƒ³ã‚¹

### 8.1 Missionå®Ÿè¡Œãƒ•ãƒ­ãƒ¼ï¼ˆå®Œå…¨ç‰ˆï¼‰

```
[Human] Quest Giver
   â†“ (1) create Mission
[Electron UI]
   â†“ (2) IPC: runMission
[SwarmOrchestrator]
   â†“ (3) API Call: generateProposal
[Executor Agent (GPT-4)]
   â†“ (4) return Proposal
[SwarmOrchestrator]
   â†“ (5) parse & validate
[SIEParser] â†’ [SIEValidator]
   â†“ (6) assessRisk
[Risk Assessor]
   â†“ (7) if risky â†’ userApprovalCallback
[Human] (æ‰¿èª or æ‹’å¦)
   â†“ (8) if approved â†’ execute
[SIEExecutor]
   â†“ (9) runAction (loop)
[BrowserManager] â†’ [Playwright]
   â†“ (10) ActionResult[]
[AuditLogger] (å…¨æ“ä½œè¨˜éŒ²)
   â†“ (11) API Call: reviewProposal
[Reviewer Agent (Claude)]
   â†“ (12) return Critique
[SwarmOrchestrator]
   â†“ (13) aggregate ScoreCard
[ScoreCard]
   â†“ (14) return to Human
[Electron UI]
```

### 8.2 Peer Review Loopï¼ˆPhase 2.5ã§å®Ÿè£…äºˆå®šï¼‰

```
Mission
   â†“
[Executor Agent 1] â†’ Proposal A
[Executor Agent 2] â†’ Proposal B
[Executor Agent 3] â†’ Proposal C
   â†“
[Reviewer Agent 1] â†’ Critique A1, B1, C1
[Reviewer Agent 2] â†’ Critique A2, B2, C2
[Reviewer Agent 3] â†’ Critique A3, B3, C3
   â†“
[ScoreCard Aggregator]
   â†’ Proposal B ãŒæœ€é«˜ã‚¹ã‚³ã‚¢ (avg: 92/100)
   â†“
[SIEExecutor] â†’ Proposal B ã‚’å®Ÿè¡Œ
```

---

## 9. å®Ÿè£…ã‚®ãƒ£ãƒƒãƒ—åˆ†æ

### 9.1 UML vs å®Ÿè£…ã‚³ãƒ¼ãƒ‰ ã®ä¸æ•´åˆ

å‰å›ã®UMLå¾©æ—§åˆ†æã§åˆ¤æ˜ã—ãŸé‡å¤§ãªä¸æ•´åˆã‚’å†æ²ã—ã¾ã™ã€‚

| é …ç›® | UMLè¨­è¨ˆï¼ˆæ­£ï¼‰ | å®Ÿè£…ã‚³ãƒ¼ãƒ‰ï¼ˆèª¤ï¼‰ | çŠ¶æ…‹ |
|------|------------|--------------|------|
| **ä¾å­˜æ–¹å‘** | SIE â†’ BrowserManager | BrowserManager â†’ SIEï¼ˆé€†ï¼ï¼‰ | âŒ è¦ä¿®æ­£ |
| **ã‚¯ãƒ©ã‚¹å** | SwarmOrchestrator | SwarmMissionRunner | âš ï¸ è¦çµ±ä¸€ |
| **SIEå®Ÿè£…** | Parser/Validatoråˆ†é›¢ | ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆãƒªãƒ†ãƒ©ãƒ«ï¼ˆã‚¹ã‚¿ãƒ–ï¼‰ | âŒ è¦å®Ÿè£… |

**ä¿®æ­£æ–¹é‡**:
- `ANTIGRAVITY_IMPL/ts-src/` é…ä¸‹ã®åˆæœŸãƒ—ãƒ­ãƒˆã‚¿ã‚¤ãƒ—ã¯**å‰Šé™¤**
- `packages/` é…ä¸‹ã®æ­£å¼å®Ÿè£…ã®ã¿ã‚’ä½¿ç”¨
- UMLé€šã‚Šã®ä¾å­˜é–¢ä¿‚ã«çµ±ä¸€

### 9.2 Phase 2.5 ã§åŸ‹ã‚ã‚‹ã¹ãã‚®ãƒ£ãƒƒãƒ—

#### ğŸ”´ Criticalï¼ˆæœ€å„ªå…ˆï¼‰

1. **å®ŸPlaywrightçµ±åˆ**
   - ç¾çŠ¶: `BrowserManager.runAction()` ãŒãƒ¢ãƒƒã‚¯
   - å¿…è¦: å®Ÿéš›ã®Playwright APIã‚’å‘¼ã³å‡ºã™å®Ÿè£…
   - å·¥æ•°: 2-3æ—¥

2. **å‹•çš„ãƒãƒªãƒ‡ãƒ¼ã‚¿ï¼ˆLLMäº‹å‰æ¤œè¨¼ï¼‰**
   - ç¾çŠ¶: é™çš„ã‚¹ã‚­ãƒ¼ãƒæ¤œè¨¼ã®ã¿
   - å¿…è¦: LLMï¼ˆé«˜ç²¾åº¦ãƒ¢ãƒ‡ãƒ«ï¼‰ã« Instruction ã‚’è¦‹ã›ã¦ã€Œå®Ÿè¡Œå¯èƒ½ã‹ï¼Ÿã€ã‚’åˆ¤å®š
   - å·¥æ•°: 3-4æ—¥

#### ğŸŸ  Highï¼ˆé‡è¦ï¼‰

3. **DOMè§£æï¼‹ã‚»ãƒ¬ã‚¯ã‚¿ç”Ÿæˆã‚¨ãƒ³ã‚¸ãƒ³**
   - ç¾çŠ¶: LLMãŒç”Ÿæˆã—ãŸã‚»ãƒ¬ã‚¯ã‚¿ã‚’ãã®ã¾ã¾ä½¿ç”¨ï¼ˆè„†å¼±ï¼‰
   - å¿…è¦: ãƒšãƒ¼ã‚¸ã®DOMãƒ„ãƒªãƒ¼ã‚’è§£æã—ã€å …ç‰¢ãªã‚»ãƒ¬ã‚¯ã‚¿ã‚’è‡ªå‹•ç”Ÿæˆ
   - å·¥æ•°: 4-5æ—¥

4. **extractï¼ˆãƒ‡ãƒ¼ã‚¿æŠ½å‡ºï¼‰å®Ÿè£…**
   - ç¾çŠ¶: ã‚¹ã‚¿ãƒ–ã®ã¿
   - å¿…è¦: Playwrightã§è¦ç´ ã‚’æŠ½å‡ºã—ã€JSONåŒ–
   - å·¥æ•°: 1-2æ—¥

#### ğŸŸ¡ Mediumï¼ˆæ®µéšçš„å®Ÿè£…ï¼‰

5. **Peer Review Loop**
   - ç¾çŠ¶: å˜ä¸€Proposalã®ã¿
   - å¿…è¦: è¤‡æ•°Proposalç”Ÿæˆ â†’ ç›¸äº’ãƒ¬ãƒ“ãƒ¥ãƒ¼ â†’ æœ€é«˜ã‚¹ã‚³ã‚¢æ¡æŠ
   - å·¥æ•°: 5-7æ—¥

---

## 10. Phase 2.5 å®Ÿè£…ãƒ­ãƒ¼ãƒ‰ãƒãƒƒãƒ—

| ã‚¹ãƒ—ãƒªãƒ³ãƒˆ | æœŸé–“ | ä¸»ãªãƒã‚¤ãƒ«ã‚¹ãƒˆãƒ¼ãƒ³ |
|------------|------|-------------------|
| **Sprint 1** | 2025-12-11ã€œ2025-12-15 | - BrowserManager ã® Playwright å®Ÿè£…å®Œäº†<br>- SIEExecutor ã‹ã‚‰å®Ÿãƒ–ãƒ©ã‚¦ã‚¶å‘¼ã³å‡ºã—ãƒ†ã‚¹ãƒˆæˆåŠŸ |
| **Sprint 2** | 2025-12-16ã€œ2025-12-22 | - å‹•çš„ãƒãƒªãƒ‡ãƒ¼ã‚¿ãƒ—ãƒ­ãƒˆã‚¿ã‚¤ãƒ—å®Ÿè£…<br>- extract ã‚¢ã‚¯ã‚·ãƒ§ãƒ³å®Ÿè£…ã¨å˜ä½“ãƒ†ã‚¹ãƒˆ |
| **Sprint 3** | 2025-12-23ã€œ2025-12-29 | - DOMè§£æã‚¨ãƒ³ã‚¸ãƒ³ (ã‚»ãƒ¬ã‚¯ã‚¿è‡ªå‹•ç”Ÿæˆ) å®Œæˆ<br>- åŸºæœ¬çš„ãª Peer Review Loop ã®ãƒ¢ãƒƒã‚¯å®Ÿè£… |
| **Sprint 4** | 2025-12-30ã€œ2026-01-05 | - å®Œå…¨ Peer Review Loop (è¤‡æ•°Proposal & Critique) å®Ÿè£…<br>- çµ±åˆãƒ†ã‚¹ãƒˆãƒ»ãƒã‚°ä¿®æ­£ |
| **Sprint 5** | 2026-01-06ã€œ2026-01-12 | - ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆæœ€çµ‚åŒ–ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒãƒ‹ãƒ¥ã‚¢ãƒ«ä½œæˆ<br>- ãƒªãƒªãƒ¼ã‚¹å€™è£œãƒ“ãƒ«ãƒ‰ã€å“è³ªä¿è¨¼ (QA) |

**ãƒªãƒªãƒ¼ã‚¹ç›®æ¨™**: 2026-01-15 ã¾ã§ã« Phase 2.5 å®Œå…¨å®Ÿè£…ç‰ˆã‚’ãƒªãƒªãƒ¼ã‚¹ã—ã€å†…éƒ¨ãƒ¬ãƒ“ãƒ¥ãƒ¼ã¨å¤–éƒ¨ LLM æŸ»èª­ã‚’å—ã‘ã‚‹ã€‚

---

## 11. æ¤œè¨¼ãƒ»ãƒ†ã‚¹ãƒˆè¨ˆç”»

### 11.1 å˜ä½“ãƒ†ã‚¹ãƒˆ
- **BrowserManager**: Playwright API å‘¼ã³å‡ºã—ã®ãƒ¢ãƒƒã‚¯/å®Ÿç’°å¢ƒãƒ†ã‚¹ãƒˆ
- **SIEExecutor**: ãƒªã‚¹ã‚¯è©•ä¾¡ãƒ­ã‚¸ãƒƒã‚¯ã€æ‰¿èªã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯ã‚·ãƒŠãƒªã‚ª
- **TOON Schemas**: Zod ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã‚«ãƒãƒ¬ãƒƒã‚¸ 100%

### 11.2 çµ±åˆãƒ†ã‚¹ãƒˆ
- **Mission â†’ Proposal â†’ Execution** ãƒ•ãƒ­ãƒ¼å…¨ä½“ã®ã‚¨ãƒ³ãƒ‰ãƒ„ãƒ¼ã‚¨ãƒ³ãƒ‰ãƒ†ã‚¹ãƒˆ
- **Peer Review Loop**: è¤‡æ•°Proposal ã¨ Critique ã®ã‚¹ã‚³ã‚¢é›†è¨ˆæ¤œè¨¼
- **Electron IPC**: `runMission` ãƒãƒ³ãƒ‰ãƒ©ã‹ã‚‰å…¨ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆå‘¼ã³å‡ºã—ã¾ã§ã®ã‚·ãƒŠãƒªã‚ªãƒ†ã‚¹ãƒˆ

### 11.3 ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒ™ãƒ³ãƒãƒãƒ¼ã‚¯
- ãƒ–ãƒ©ã‚¦ã‚¶èµ·å‹•ãƒ»ãƒšãƒ¼ã‚¸é·ç§»æ™‚é–“ (ç›®æ¨™ < 2s)
- SIEExecutor ã®æŒ‡ç¤ºå®Ÿè¡Œãƒ¬ãƒ¼ãƒˆ (ç›®æ¨™ 10 æŒ‡ç¤º/ç§’)
- AuditLog æ›¸ãè¾¼ã¿ã‚¹ãƒ«ãƒ¼ãƒ—ãƒƒãƒˆ (ç›®æ¨™ 5000 è¡Œ/ç§’)

### 11.4 ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ¬ãƒ“ãƒ¥ãƒ¼
- **ãƒªã‚¹ã‚¯ã‚¢ã‚»ãƒƒã‚µ**: ç ´å£Šçš„æ“ä½œæ¤œå‡ºã®ã‚«ãƒãƒ¬ãƒƒã‚¸ç¢ºèª
- **User Approval**: é«˜ãƒªã‚¹ã‚¯æ“ä½œæ™‚ã® UI/CLI æ‰¿èªãƒ•ãƒ­ãƒ¼æ¤œè¨¼
- **Sandbox**: Antigravity Sandbox ã®ã‚µãƒ³ãƒ‰ãƒœãƒƒã‚¯ã‚¹å¢ƒç•Œãƒ†ã‚¹ãƒˆ

---

## 12. ä»˜éŒ²

### 12.1 ç”¨èªé›†
- **Mission**: Human ãŒå®šç¾©ã™ã‚‹ã‚¿ã‚¹ã‚¯è¦ä»¶
- **Proposal**: Executor Agent ãŒç”Ÿæˆã™ã‚‹è§£æ±ºæ¡ˆã¨å®Ÿè¡ŒæŒ‡ç¤ºåˆ—
- **Critique**: Reviewer Agent ãŒæä¾›ã™ã‚‹è©•ä¾¡ã¨ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯
- **ScoreCard**: è¤‡æ•° Critique ã‚’é›†è¨ˆã—ãŸæœ€çµ‚è©•ä¾¡
- **SIE**: Structured Instruction Executorã€TOON Instruction ã®å®Ÿè¡Œã‚¨ãƒ³ã‚¸ãƒ³
- **BrowserManager**: Playwright ã‚’ç”¨ã„ãŸãƒ–ãƒ©ã‚¦ã‚¶ãƒ»ãƒªã‚½ãƒ¼ã‚¹ç®¡ç†å±¤
- **Antigravity Sandbox**: Node.js äº’æ›ã®å®‰å…¨å®Ÿè¡Œç’°å¢ƒ

### 12.2 å‚è€ƒãƒªãƒ³ã‚¯
- [GLIA Specification Repository](https://github.com/hiro-tana/GLIA-V1/tree/main/SPECIFICATION)
- [Playwright Documentation](https://playwright.dev/docs/intro)
- [Zod Schema Validation](https://zod.dev/)
- [OpenRouter API Docs](https://openrouter.ai/docs)

---

*ã“ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã¯ ChatGPT ã¨ Claude ã®ãƒ¬ãƒ“ãƒ¥ãƒ¼ç”¨ã«æœ€é©åŒ–ã•ã‚Œã¦ãŠã‚Šã€å…¨ä½“åƒã¨å®Ÿè£…ã‚®ãƒ£ãƒƒãƒ—ã€ä»Šå¾Œã®ãƒ­ãƒ¼ãƒ‰ãƒãƒƒãƒ—ã‚’ç¶²ç¾…çš„ã«ç¤ºã—ã¦ã„ã¾ã™ã€‚*
